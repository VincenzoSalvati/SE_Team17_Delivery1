<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" rel="stylesheet">
    <link href="../CSS/4_assignHours.css" rel="stylesheet">
    <title>Assign to Maintainer</title>
</head>

<script crossorigin="anonymous"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="../JAVASCRIPT/4_script.js"></script>

<body style="background-color: rgb(228, 228, 228)">

<div class="topnav">
    <a align="center" style="color: white"></a>
    <a align="center" id="week" style="color: white"></a>

    <a align="center" style="color: white"></a>
    <a align="center" id="giorno" style="color: white"></a>

    <a align="center" style="color: white"></a>
    <a align="center" id="numero" style="color: white"></a>

    <a align="center" style="color: white"></a>
    <a align="center" id="strActivity" style="color: white"></a>
</div>

<div class="container-fluid">

    <div class="alert alert-success collapse" id="alert" role="alert" style="margin-top: 20px">
        <a class="close" href="#" id="linkClose">&times;</a>
        Maintainance activity <strong>successfully</strong> assigned.
    </div>

    <div class="alert alert-warning collapse" id="alertWarning" role="alert" style="margin-top: 20px">
        <a class="close" href="#" id="linkCloseWarning">&times;</a>
        <strong>Attention</strong> this Maintainer is unavailable (full-time occuped).
    </div>

    <div _ngcontent-whm-c5="" class="card" style="top: 70px; width: 90%; margin-left: 5%">
        <div class="card-header card-header-warning">
            <h4 class="card-title" id="availMaint" style="font-size: x-large; width: 50%"></h4>
            <h4 id="strPerc" style="font-size: x-large;"></h4>
            <p class="card-category" style="font-size: larger;">All the availability of the maintainers during the day
                selected.</p>
        </div>

        <div class="card-body table-responsive">
            <table class="table table">
                <thead>
                <tr style="background-color: orange;">
                    <th>Maintainer</th>
                    <th>Skills</th>
                    <th>Availab. 8:00-9:00</th>
                    <th>Availab. 9:00-10:00</th>
                    <th>Availab. 10:00-11:00</th>
                    <th>Availab. 11:00-12:00</th>
                    <th>Availab. 14:00-15:00</th>
                    <th>Availab. 15:00-16:00</th>
                    <th>Availab. 16:00-17:00</th>
                </tr>
                <template id="maintainerday-row-template">
                    <tr style="font-size: medium">
                        <td style="background-color: white; display: none"><a id="link_id">{Id}</a></td>
                        <td style="background-color: white"><a id="link_maint"> {Maint} </a></td>
                        <td style="background-color: white">{Skills}</td>
                        <td class="cell" style="background-color: white; text-decoration: none">
                            <a class="link_8to9" href="#" id="link_8to9" onclick="selectHour('checkId0', 'link_8to9')">
                                {h8to9} min
                            </a>
                            <img id="checkId0" src="../img/check.png"
                                 style="visibility: hidden; margin-left: 10px; width: 20%;">
                        </td>
                        <td class="cell" style="background-color: white; text-decoration: none">
                            <a class="link_9to10" href="#" id="link_9to10"
                               onclick="selectHour('checkId1', 'link_9to10')">
                                {h9to10} min
                            </a>
                            <img id="checkId1" src="../img/check.png"
                                 style="visibility: hidden; margin-left: 10px; width: 20%;">
                        </td>
                        <td class="cell" style="background-color: white; text-decoration: none">
                            <a class="link_10to11" href="#" id="link_10to11"
                               onclick="selectHour('checkId2', 'link_10to11')">
                                {h10to11} min
                            </a>
                            <img id="checkId2" src="../img/check.png"
                                 style="visibility: hidden; margin-left: 10px; width: 20%;">
                        </td>
                        <td class="cell" style="background-color: white; text-decoration: none">
                            <a class="link_11to12" href="#" id="link_11to12"
                               onclick="selectHour('checkId3', 'link_11to12')">
                                {h11to12} min
                            </a>
                            <img id="checkId3" src="../img/check.png"
                                 style="visibility: hidden; margin-left: 10px; width: 20%;">
                        </td>
                        <td class="cell" style="background-color: white; text-decoration: none">
                            <a class="link_14to15" href="#" id="link_14to15"
                               onclick="selectHour('checkId4', 'link_14to15')">
                                {h14to15} min
                            </a>
                            <img id="checkId4" src="../img/check.png"
                                 style="visibility: hidden; margin-left: 10px; width: 20%;">
                        </td>
                        <td class="cell" style="background-color: white; text-decoration: none">
                            <a class="link_15to16" href="#" id="link_15to16"
                               onclick="selectHour('checkId5', 'link_15to16')">
                                {h15to16} min
                            </a>
                            <img id="checkId5" src="../img/check.png"
                                 style="visibility: hidden; margin-left: 10px; width: 20%;">
                        </td>
                        <td class="cell" style="background-color: white; text-decoration: none">
                            <a class="link_16to17" href="#" id="link_16to17"
                               onclick="selectHour('checkId6', 'link_16to17')">
                                {h16to17} min
                            </a>
                            <img id="checkId6" src="../img/check.png"
                                 style="visibility: hidden; margin-left: 10px; width: 20%;">
                        </td>
                    </tr>
                </template>
                </thead>

                <tbody id="maintainer-rows">
                </tbody>
                <tfoot>
                <tr>
                    <th colspan="6">
                        <span id="request-status"></span>
                    </th>
                </tr>

                </tfoot>

            </table>

            <center>
                <button class="btn btn-primary" id="forward" style="pointer-events: none; opacity: 0.5;" type="button">
                    Forward
                </button>
                <button class="btn btn-danger" onclick="clearHour()" style="margin-left: 20px" type="button">Clear
                </button>
            </center>

            <h2>Estimated time <span class="badge badge-secondary" id="totalMin"></span></h2>

        </div>
    </div>


    <div _ngcontent-whm-c5="" class="card" style="top: 100px; width: 50%; margin-left: 6%">
        <div class="card-header card-header-warning">
            <h4 class="card-title" style="font-size: larger; width: 50%">Workspace Notes</h4>
            <p class="card-category" style="font-size: larger;">All the additional details about the maintainance
                activity.</p>
        </div>

        <div class="card-body table-responsive">
            <table class="table table">
                <tr id="strWorkNote" style="font-size: larger; color: gray;"></tr>
            </table>
        </div>

    </div>

</div>

</body>

<!--CONSTANT-->
<script>
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const activity = urlParams.get('activity')
    const week = urlParams.get('week')
    const specifications = urlParams.get('specifications')
    const maintainer = urlParams.get('maintainer')
    const day = urlParams.get('day')
    const stringActivity = urlParams.get("strActivity")
    const stringWorkNote = urlParams.get("strWorkNote")
    const perc = urlParams.get("perc")
    const estimatedTime = urlParams.get("time")
    var current_time = estimatedTime;

    //dizionario che memorizza i minuti selezionati
    var dict = [];
    //id autoincrementale che tiene traccia dei vari minuti selezionati
    var id = 0;

    //parameters to be sent to the db
    var avail_8to9 = 0;
    var avail_9to10 = 0;
    var avail_10to11 = 0;
    var avail_11to12 = 0;
    var avail_14to15 = 0;
    var avail_15to16 = 0;
    var avail_16to17 = 0;

    var id_availability = 0;

    document.getElementById("week").innerHTML = "Week " + week;
    document.getElementById("strWorkNote").innerHTML = stringWorkNote;
    document.getElementById("strActivity").innerHTML = stringActivity;
    document.getElementById("strPerc").innerHTML = perc + "%";
    document.getElementById("giorno").innerHTML = day;
    document.getElementById("totalMin").innerHTML = estimatedTime;
</script>

<!--script per prendere il valore del giorno-->
<script>
    var dat = new Date();
    var d = dat.getDay();
    document.getElementById("numero").innerHTML = dat.getDate();
    if (d === 1) {
        sett = "Monday";
    } else if (d === 2) {
        sett = "Tuesday";
    } else if (d === 3) {
        sett = "Wednesday";
    } else if (d === 4) {
        sett = "Thursday";
    } else if (d === 5) {
        sett = "Friday";
    } else if (d === 6) {
        sett = "Saturday";
    } else if (d === 0) {
        sett = "Sunday";
    }
    document.getElementById("giorno").innerHTML = sett;
</script>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="../JAVASCRIPT/4_BrowseController.js" type="text/javascript"></script>

<script type="application/javascript">
    $(document).ready(function () {
        let controller = new BrowseController();
        controller.initBrowseView(activity, week, specifications, maintainer, day);
    });
</script>

<script type="application/javascript">
    $(document).ready(function () {
        $('#forward').click(function () {
            $('#alert').show('fade');

            initParams();
            updateDB();

        });

        $('#linkClose').click(function () {
            $('#alert').hide('fade');
            location.reload();
        });

        $('#linkCloseWarning').click(function () {
            $('#alertWarning').hide('fade');
        });
    });
</script>

</html>